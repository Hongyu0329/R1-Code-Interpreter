O(n\sqrt{A}\log(n\sqrt{A}))