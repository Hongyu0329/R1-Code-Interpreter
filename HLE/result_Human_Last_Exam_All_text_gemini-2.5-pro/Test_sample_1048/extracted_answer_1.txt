O(n log n + nV)