import numpy as np

# 1. Define the geometric objects.
# P with log structure N^3 corresponds to a cone generated by the standard basis vectors.
original_cone_generators = np.array([[1, 0, 0],
                                     [0, 1, 0],
                                     [0, 0, 1]])

# The ideal I is generated by the vectors (1,0,0) and (0,1,0).
ideal_generators = np.array([[1, 0, 0],
                             [0, 1, 0]])

# 2. Determine the dimension of the original space.
original_dim = np.linalg.matrix_rank(original_cone_generators)
print(f"The original space corresponds to a cone generated by vectors:")
print(original_cone_generators)
print(f"The dimension of the original space is {original_dim}.\n")

# 3. Perform the blowup by subdividing the cone.
# A new ray is introduced, which is the sum of the ideal generators.
new_ray = np.sum(ideal_generators, axis=0)
print(f"The log ideal is generated by e1 = {ideal_generators[0]} and e2 = {ideal_generators[1]}.")
print(f"The blowup introduces a new ray v = e1 + e2 = {new_ray}.\n")

# The original cone is subdivided into two new cones.
# Cone 1 is generated by {v, e2, e3}
cone1_generators = np.array([new_ray, original_cone_generators[1], original_cone_generators[2]])
# Cone 2 is generated by {v, e1, e3}
cone2_generators = np.array([new_ray, original_cone_generators[0], original_cone_generators[2]])

# 4. Calculate the dimension of the new cones.
dim1 = np.linalg.matrix_rank(cone1_generators)
dim2 = np.linalg.matrix_rank(cone2_generators)

print("The new fan has two maximal cones. We find their dimensions:")
print("Generators of the first new cone:")
print(cone1_generators)
print(f"Dimension of the first new cone = {dim1}\n")

print("Generators of the second new cone:")
print(cone2_generators)
print(f"Dimension of the second new cone = {dim2}\n")

# 5. The dimension of the blowup is the maximum dimension of the new cones.
blowup_dimension = max(dim1, dim2)

print("The dimension of the log blowup is the maximum of the dimensions of the new cones.")
print(f"Final Dimension = max({dim1}, {dim2}) = {blowup_dimension}")