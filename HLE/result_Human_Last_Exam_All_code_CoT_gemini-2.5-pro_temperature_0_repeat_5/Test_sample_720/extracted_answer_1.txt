O(n * d^2 + n^2 * d)