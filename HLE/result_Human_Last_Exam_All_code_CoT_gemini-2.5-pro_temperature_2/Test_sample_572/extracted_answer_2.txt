r = floor(N * (1 - sqrt(2*delta)))