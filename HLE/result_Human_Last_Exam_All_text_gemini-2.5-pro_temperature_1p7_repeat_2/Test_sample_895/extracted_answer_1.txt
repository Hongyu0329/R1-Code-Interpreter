sin(phi) * max_{i=1 to n} (a_i * a_{i+1} / b_i)