O(n^2 d)