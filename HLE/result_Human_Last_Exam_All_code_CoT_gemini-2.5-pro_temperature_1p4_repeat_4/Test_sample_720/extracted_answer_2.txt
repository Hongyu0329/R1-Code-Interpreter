O(d^2*n + d*n^2 + n^3)