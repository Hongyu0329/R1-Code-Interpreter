O(nm * 2^(nm))