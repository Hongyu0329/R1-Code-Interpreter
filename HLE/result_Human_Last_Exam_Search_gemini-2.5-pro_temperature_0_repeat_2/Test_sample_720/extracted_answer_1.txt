O(d²n + n³)