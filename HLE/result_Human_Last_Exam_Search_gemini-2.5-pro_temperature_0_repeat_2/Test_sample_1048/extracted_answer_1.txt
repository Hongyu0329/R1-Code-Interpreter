O(k * 2^k * M), where k is the number of elements a_i <= x and M is the maximum value among them.