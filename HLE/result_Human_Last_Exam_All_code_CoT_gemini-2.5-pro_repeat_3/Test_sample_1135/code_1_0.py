def solve_ccs_matrix_element_question():
    """
    Explains for which excited Slater determinants |Phi_I> the matrix element
    <Phi_I | H-bar | Phi> is zero in CCSD theory, based on a connectivity argument.
    H-bar is the similarity-transformed Hamiltonian, and |Phi> is the reference determinant.
    """

    print("### The CCSD Problem ###")
    print("In the Coupled Cluster Singles and Doubles (CCSD) method, the amplitudes defining the cluster operator T = T1 + T2 are found by ensuring that projections onto singly and doubly excited determinants are zero:")
    print("  <Phi_S | H-bar | Phi> = 0")
    print("  <Phi_D | H-bar | Phi> = 0")
    print("The question is: For which OTHER excited Slater determinants |Phi_I> is this matrix element also zero?")
    print("-" * 60)

    print("### The Key Argument: Connectivity of H-bar ###")
    print("The similarity-transformed Hamiltonian, H-bar, can be expressed via the linked-cluster theorem as H-bar = (H * exp(T))_C.")
    print("This means H-bar is a sum of operators represented by connected diagrams, each containing one Hamiltonian (H) vertex and some number of T-operator vertices.")
    print("\nCrucially:")
    print("1. The electronic Hamiltonian 'H' contains at most two-body terms. This means its vertex has at most 4 connection points (lines).")
    print("2. In CCSD, T = T1 + T2.")
    print("3. For a diagram to be 'connected', all T vertices must link back to the single H vertex.")
    print("-" * 60)

    print("### Maximum Excitation Level ###")
    print("Since the H vertex has only 4 lines, it can connect to a limited number of T operators.")
    print("The maximum number of excitations that can be generated by H-bar acting on the reference |Phi> is determined by the most complex connected diagram we can form.")
    print("\nIt can be shown that the most complex operator that can be formed by connecting T1 and T2 operators to a two-body H vertex is a four-particle, four-hole (4p-4h) operator.")
    print("For example, a diagram where H is connected to two T2 operators can result in a 4p-4h operator.")
    print("\nWhen such a 4p-4h operator acts on the reference determinant |Phi>, it generates a quadruply excited determinant |Phi_Q>.")
    print("It is impossible to form a 5p-5h or higher operator because of the limited connectivity of the single H vertex.")
    print("\nTherefore, the state H-bar|Phi> contains components up to, but not exceeding, quadruple excitations:")
    print("  H-bar |Phi> = c_0|Phi> + c_S|S> + c_D|D> + c_T|T> + c_Q|Q>")
    print("-" * 60)

    print("### Conclusion ###")
    print("We know from the definition of CCSD that the coefficients for singles (S) and doubles (D) are zero.")
    print("From our connectivity argument, the state H-bar|Phi> has no components from pentuply, sextuply, or higher excitations. This means their coefficients must also be zero.")
    
    print("\nThis implies that the matrix element <Phi_I | H-bar | Phi> is zero for any determinant |Phi_I> corresponding to an excitation level 'n' greater than or equal to 5.")
    print("\nThe final equations and the corresponding excitation numbers 'n' are:")
    
    # Using a loop to demonstrate the output format
    for n in range(5, 8):
        print(f"For n = {n}: <Phi_I({n}) | H-bar | Phi> = 0")
    print("... and so on for all n > 4.")


solve_ccs_matrix_element_question()
<<<For all excited Slater determinants of level five (pentuply excited) and higher.>>>