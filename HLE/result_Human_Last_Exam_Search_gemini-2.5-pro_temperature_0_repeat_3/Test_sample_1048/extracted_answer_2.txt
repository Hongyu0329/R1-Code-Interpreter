O(M * n * 2^(n/2))