This workflow provides a robust, data-driven method to remove contamination artifacts based on log2 fold change, suitable for direct implementation in a command-line bioinformatics pipeline. The key is to leverage the extreme negative log2 fold change values that arise from the presence of cancer cells in one experimental group and their absence in the other.
**Step 1: Identify Contaminant Genes**
Use `awk` to parse the differential expression results file and create a list of gene IDs that show both a highly negative log2 fold change (e.g., < -5) and a statistically significant adjusted p-value (e.g., < 0.01).
```bash
awk -F'\t' 'NR > 1 && $3 < -5 && $7 < 0.01 {print $1}' de_results.tsv > contaminant_genes.txt
```
*(Assuming `de_results.tsv` is your results file where column 1 is the gene ID, column 3 is log2FoldChange, and column 7 is the adjusted p-value).*

**Step 2: Filter the Full Dataset**
Use `grep` to remove the identified contaminant genes from the complete differential expression results file to create a clean file for downstream analysis.
```bash
grep -v -w -f contaminant_genes.txt de_results.tsv > de_results_filtered.tsv
```
The resulting `de_results_filtered.tsv` file is now ready for accurate biological interpretation.