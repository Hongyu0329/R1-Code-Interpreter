O(n*sqrt(A)*(log(n) + log(A)))