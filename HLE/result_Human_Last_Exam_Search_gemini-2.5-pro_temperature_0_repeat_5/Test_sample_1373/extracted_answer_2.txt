O(n(M + n)) or O(nM + n^2)