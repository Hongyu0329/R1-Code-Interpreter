O(2^n * n * M)