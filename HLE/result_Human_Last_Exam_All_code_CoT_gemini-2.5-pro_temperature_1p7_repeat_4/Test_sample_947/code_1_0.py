import sympy as sp

def calculate_magnetic_field_expression():
    """
    Calculates and prints the symbolic expression for the magnetic field
    around an infinite stack of superconducting strips.
    """
    # Define the symbolic variables used in the equation
    H_a = sp.Symbol('H_a', real=True)
    H_0 = sp.Symbol('H_0', real=True, positive=True)
    w = sp.Symbol('w', real=True, positive=True)
    D = sp.Symbol('D', real=True, positive=True)
    x = sp.Symbol('x', real=True)
    z = sp.Symbol('z', real=True)
    pi = sp.pi

    # The problem asks for the expression for the magnetic field H_z(x,z).
    # The physical model assumes the strips are fully penetrated by the magnetic flux.
    # The total field is the sum of the applied field (H_a) and the field generated
    # by the screening currents in all the strips.
    # In the limit where the observation point x is far from the stack (|x| >> w),
    # the field generated by the stack has a specific analytical form.

    # The amplitude of the field perturbation depends on the penetration field H0,
    # and the geometry of the stack (w and D).
    # The spatial dependence shows an exponential decay away from the stack in the x-direction,
    # and a periodic variation in the z-direction corresponding to the strip spacing.

    # Here we construct the expression term by term.
    # Amplitude factor depending on H0 and geometry
    amplitude = 2 * H_0 * (sp.sinh(pi * w / D))**2

    # Z-dependence (periodic)
    z_dependence = sp.cos(2 * pi * z / D)

    # X-dependence (exponential decay for large |x|)
    x_dependence = sp.exp(-2 * pi * sp.Abs(x) / D)

    # The field generated by the currents in the strips
    field_from_strips = amplitude * z_dependence * x_dependence

    # The total magnetic field is the sum of the applied field and the strips' field
    H_z_expression = H_a + field_from_strips

    # Create a symbolic representation of the equation H_z(x,z) = ...
    equation = sp.Eq(sp.Symbol('H_z(x,z)'), H_z_expression)

    # Print the final, formatted equation for the user
    print("The final expression for the magnetic field H_z(x,z) is:")
    sp.pprint(equation, use_unicode=True, wrap_line=False)

# Execute the function to derive and print the result
calculate_magnetic_field_expression()