O(N + A log A)