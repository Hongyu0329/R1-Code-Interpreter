O(n + k * 2^k * M)