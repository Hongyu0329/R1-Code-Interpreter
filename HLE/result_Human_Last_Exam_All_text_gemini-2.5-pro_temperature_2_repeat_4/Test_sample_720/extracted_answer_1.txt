O(d^2n + dn^2 + n^3)