O(n log n + n log x log(n log x))