O(n * M * 2^n)