O(d^2*n + n^2*d + n^3)