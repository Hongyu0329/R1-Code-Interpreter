(N1*N2 + N1*M2 + M1*M2) + 0.5 * (N1*M1 + M1*N2 + N2*M2)