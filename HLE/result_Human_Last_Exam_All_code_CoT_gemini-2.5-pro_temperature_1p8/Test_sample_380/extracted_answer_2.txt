Your analysis is correct. For AIC waves, helicity must be calculated using magnetic components perpendicular to the local magnetic field, not the radial direction. The local field at L1 is generally not radial due to the Parker Spiral. Using radial-based coordinates is a simplification that is not physically rigorous. The provided Python code demonstrates the proper method of transforming data into a Mean Field Aligned (MFA) coordinate system to obtain the correct components for the helicity calculation.