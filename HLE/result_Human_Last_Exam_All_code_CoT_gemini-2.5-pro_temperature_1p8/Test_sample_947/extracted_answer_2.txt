H_z(x, z) = H_a + (J_c * d) / (2 * pi) * [ atan( (sin(2*pi*x/D)*sinh(2*pi*z/D)) / (cos(2*pi*a/D) - cos(2*pi*x/D)*cosh(2*pi*z/D)) ) - atan( (sin(2*pi*x/D)*sinh(2*pi*z/D)) / (cos(2*pi*w/D) - cos(2*pi*x/D)*cosh(2*pi*z/D)) ) ], where a is given by cosh(pi*a/D) = cosh(pi*w/D) / cosh(H_a/H_0) and H_0 = J_c*d/pi.