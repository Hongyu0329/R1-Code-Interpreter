O(n * (M + 12*n))