O(d^2 n + dn^2 + n^3)