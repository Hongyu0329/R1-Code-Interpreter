import math

def calculate_surface_dose():
    """
    Calculates the cumulative surface dose based on synchrotron imaging system parameters.
    """
    # --- Input Parameters from the problem statement ---
    focus_width_h_mm = 0.3
    focus_width_v_mm = 6.0
    chamber_current_pA = 2.0
    air_density_mg_cm3 = 1.293
    chamber_length_cm = 15.1
    dwell_time_s = 0.02
    
    # Standard physical constant for dry air.
    # W/e is the average energy required to create an ion pair, approximately 33.97 Joules per Coulomb.
    W_over_e_air_J_per_C = 33.97

    # --- Unit Conversions for Calculation ---
    # Convert all units to a consistent system (cm, g, s, C) before final conversion to SI for dose.
    focus_width_h_cm = focus_width_h_mm / 10.0
    focus_width_v_cm = focus_width_v_mm / 10.0
    air_density_g_cm3 = air_density_mg_cm3 / 1000.0
    chamber_current_C_per_s = chamber_current_pA * 1e-12

    # --- Step-by-Step Calculation ---

    # 1. Calculate the mass of air in the exposed volume of the ionization chamber.
    # The assumption is that the ionization current is generated by this mass of air.
    beam_area_at_focus_cm2 = focus_width_h_cm * focus_width_v_cm
    exposed_volume_cm3 = beam_area_at_focus_cm2 * chamber_length_cm
    exposed_mass_g = exposed_volume_cm3 * air_density_g_cm3
    
    # Convert mass to kilograms for SI unit of Dose (Gray = J/kg).
    exposed_mass_kg = exposed_mass_g / 1000.0

    # 2. Calculate the dose rate in Gray per second (Gy/s).
    # Dose Rate = (Energy deposited per second) / mass
    # Energy deposited per second = Current (Charge/s) * (Energy/Charge)
    energy_deposition_rate_J_per_s = chamber_current_C_per_s * W_over_e_air_J_per_C
    dose_rate_Gy_per_s = energy_deposition_rate_J_per_s / exposed_mass_kg

    # 3. Calculate the cumulative dose for a point on the surface.
    # This is the dose rate multiplied by the time the beam is on that point (dwell time).
    cumulative_dose_Gy = dose_rate_Gy_per_s * dwell_time_s

    # 4. Convert final dose to milliGray (mGy) for readability.
    cumulative_dose_mGy = cumulative_dose_Gy * 1000.0
    
    # --- Output Results ---
    print("--- Calculation of Cumulative Surface Dose ---")
    print("\nThe cumulative dose is calculated by multiplying the dose rate by the exposure time for a single point.")
    print("The dose rate is derived from the ionization current measurement.\n")
    print("Final Equation:")
    print("Dose (mGy) = ( (Ionization Current (C/s) * W/e (J/C)) / Exposed Air Mass (kg) ) * Exposure Time (s) * 1000 (mGy/Gy)\n")
    
    # Print the final equation with all the numbers used in the calculation.
    # Note: Values are shown with reasonable precision for clarity.
    print("Substituting the given values:")
    final_equation = (f"Dose (mGy) = ( ({chamber_current_C_per_s:.1e} * {W_over_e_air_J_per_C}) / "
                      f"({focus_width_h_cm:.2f} * {focus_width_v_cm:.1f} * {chamber_length_cm:.1f} * {air_density_g_cm3:.6f} / 1000) ) "
                      f"* {dwell_time_s:.2f} * 1000")
    print(final_equation + "\n")

    print("Step-by-step breakdown:")
    print(f"Exposed Air Mass = ({focus_width_h_cm:.2f} cm * {focus_width_v_cm:.1f} cm * {chamber_length_cm:.1f} cm) * {air_density_g_cm3:.6f} g/cm^3 = {exposed_mass_kg:.5e} kg")
    print(f"Dose Rate = ({chamber_current_C_per_s:.1e} C/s * {W_over_e_air_J_per_C:.2f} J/C) / {exposed_mass_kg:.5e} kg = {dose_rate_Gy_per_s:.5f} Gy/s")
    print(f"Cumulative Dose = {dose_rate_Gy_per_s:.5f} Gy/s * {dwell_time_s:.2f} s = {cumulative_dose_Gy:.5e} Gy\n")

    print("Final Answer:")
    print(f"The cumulative surface dose is {cumulative_dose_mGy:.5f} mGy.")
    
    # Returning the final value for the "answer" tag
    return cumulative_dose_mGy

# Execute the calculation and print the result
final_dose = calculate_surface_dose()
print(f"\n<<<{final_dose:.5f}>>>")
