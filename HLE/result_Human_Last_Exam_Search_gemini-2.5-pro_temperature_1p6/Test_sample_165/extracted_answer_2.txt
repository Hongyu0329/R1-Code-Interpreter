The number of impossible initial values of $S$ depends on the parity of $k$.
If $k$ is even, the number of such sets is $\frac{1}{2} \left( \binom{2k+1}{n} - (-1)^{(n-1)/2} \binom{k}{(n-1)/2} \right)$.
If $k$ is odd, the number is $\frac{1}{2} \left( \binom{2k+1}{n} + (-1)^{(n-1)/2} \binom{k}{(n-1)/2} \right)$.
In these formulas, $\binom{n}{r}$ is the binomial coefficient, which is zero if $r>n$ or $r<0$.