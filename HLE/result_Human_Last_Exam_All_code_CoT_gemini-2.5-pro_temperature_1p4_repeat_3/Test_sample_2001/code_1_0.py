import math

def simulate_flow_cytometry_signal():
    """
    Simulates the signal from a magnetic flow cytometer to demonstrate
    the effect of magnet positioning on the sensor.
    """
    # --- System Parameters ---
    # Sensor property: Maximum output voltage before saturation
    sensor_saturation_voltage = 1.0  # Volts

    # Overall system gain: A factor that converts magnet field strength to sensor voltage
    # It lumps together particle susceptibility, volume, geometry, and sensor sensitivity.
    system_gain = 20.0  # V/T (Volts per Tesla)

    # --- Scenarios ---
    # 1. Properly positioned magnet providing an optimal field
    proper_magnet_field = 0.04  # Tesla

    # 2. Improperly positioned magnet (too close) providing an excessive field
    improper_magnet_field = 0.08  # Tesla

    # --- Calculations ---
    # Calculate the ideal signal voltage generated by a particle in the proper field
    # Equation: Signal_Voltage = Magnetic_Field * System_Gain
    ideal_signal_proper = proper_magnet_field * system_gain

    # The actual measured signal is capped by the sensor's saturation voltage
    measured_signal_proper = min(ideal_signal_proper, sensor_saturation_voltage)

    # Calculate the ideal signal voltage generated by a particle in the improper (strong) field
    ideal_signal_improper = improper_magnet_field * system_gain

    # The actual measured signal is capped by the sensor's saturation voltage
    measured_signal_improper = min(ideal_signal_improper, sensor_saturation_voltage)

    # --- Output Results ---
    print("--- Simulation of Magnet Position Effect ---")

    print("\nScenario 1: Properly Positioned Magnet")
    print(f"The equation for the ideal signal is: Voltage = Magnetic Field * System Gain")
    print(f"Ideal Signal = {proper_magnet_field} T * {system_gain} V/T = {ideal_signal_proper:.2f} V")
    print(f"The sensor's maximum output (saturation point) is {sensor_saturation_voltage:.2f} V.")
    print(f"Result: The ideal signal ({ideal_signal_proper:.2f} V) is within the sensor's range.")
    print(f"Final Measured Signal: {measured_signal_proper:.2f} V (Accurate Measurement)")

    print("\nScenario 2: Improperly Positioned Magnet (Field Too Strong)")
    print(f"The equation for the ideal signal is: Voltage = Magnetic Field * System Gain")
    print(f"Ideal Signal = {improper_magnet_field} T * {system_gain} V/T = {ideal_signal_improper:.2f} V")
    print(f"The sensor's maximum output (saturation point) is {sensor_saturation_voltage:.2f} V.")
    print(f"Result: The ideal signal ({ideal_signal_improper:.2f} V) exceeds the sensor's range.")
    print(f"Final Measured Signal: {measured_signal_improper:.2f} V (Sensor is Saturated)")

    print("\nConclusion: An improperly positioned magnet creating a strong field can cause Spin Valve Saturation, corrupting the data.")


# Run the simulation
simulate_flow_cytometry_signal()