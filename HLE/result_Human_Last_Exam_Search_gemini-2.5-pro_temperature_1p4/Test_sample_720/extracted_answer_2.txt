O(nd² + d³)