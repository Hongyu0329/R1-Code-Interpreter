O(nd^2 + d^3)