O(n * 2^(nm+m) + m * 2^(nm+n))