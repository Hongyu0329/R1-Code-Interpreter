O(n log n + 2^m)