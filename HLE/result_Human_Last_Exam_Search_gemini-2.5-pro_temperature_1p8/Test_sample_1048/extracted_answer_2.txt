O(n log n + n^2 * 2^n * max(a_i))