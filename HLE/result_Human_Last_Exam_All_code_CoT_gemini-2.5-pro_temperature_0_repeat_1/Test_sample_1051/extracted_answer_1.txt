O(A + n * sqrt(A))