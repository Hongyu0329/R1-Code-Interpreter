O(M*n + n^2)