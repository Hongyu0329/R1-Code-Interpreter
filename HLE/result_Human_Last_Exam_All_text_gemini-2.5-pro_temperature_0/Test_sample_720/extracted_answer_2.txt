O(d^2 n)