O(n^2 * d + n^3)