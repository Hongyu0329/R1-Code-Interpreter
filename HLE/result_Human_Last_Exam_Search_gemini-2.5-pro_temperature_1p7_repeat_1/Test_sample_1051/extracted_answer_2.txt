O(min(n + A log A, n * (Î£ a_i)^0.5))