import math

# Step 1: Define all the given values from the problem description and diagram.

# Load real power values (in MW)
p_load1 = 1.89
p_load2 = 1.75
p_load3 = 1.7
p_load4 = 1.9
p_load5 = 2.4

# Generator apparent power values (in MVA)
s_hydro_gen = 2.0
s_pv = 3.0
s_mini_hydro_gen = 1.2

# Power factors
pf_sources = 0.9  # For Hydro, Mini Hydro, and Load 3
pf_pv = 0.92      # For Photovoltaic system

# Losses
harmonic_loss_rate = 0.05  # 5% for Load 2 and Load 4
pv_transmission_loss_rate = 0.04  # 4% for PV system

# Step 2: Calculate the total power demand from all loads, including losses.

# Calculate power for loads with harmonic losses
p_load2_actual = p_load2 * (1 + harmonic_loss_rate)
p_load4_actual = p_load4 * (1 + harmonic_loss_rate)

# Calculate total load
total_load_power = p_load1 + p_load2_actual + p_load3 + p_load4_actual + p_load5

# Step 3: Calculate the total real power supplied by the generators, including losses.

# Calculate real power generated by each source
p_hydro_gen = s_hydro_gen * pf_sources
p_mini_hydro_gen = s_mini_hydro_gen * pf_sources
p_pv_generated = s_pv * pf_pv

# Calculate power delivered by PV after transmission losses
p_pv_delivered = p_pv_generated * (1 - pv_transmission_loss_rate)

# Calculate total generation
total_generation_power = p_hydro_gen + p_pv_delivered + p_mini_hydro_gen

# Step 4: Calculate the net real power demand on Bus 11.
net_real_power_demand = total_load_power - total_generation_power

# Step 5: Print the detailed calculation and the final result.

print("Calculation of Total Net Real Power Demand on Bus 11 (in MW)")
print("-" * 60)

print("1. Total Power Demand (Loads):")
print(f"  Load 1 = {p_load1:.2f} MW")
print(f"  Load 2 (with 5% harmonic loss) = {p_load2:.2f} * {1 + harmonic_loss_rate} = {p_load2_actual:.4f} MW")
print(f"  Load 3 = {p_load3:.2f} MW")
print(f"  Load 4 (with 5% harmonic loss) = {p_load4:.2f} * {1 + harmonic_loss_rate} = {p_load4_actual:.4f} MW")
print(f"  Load 5 = {p_load5:.2f} MW")
print(f"  Total Load = {p_load1:.2f} + {p_load2_actual:.4f} + {p_load3:.2f} + {p_load4_actual:.4f} + {p_load5:.2f} = {total_load_power:.4f} MW")
print()

print("2. Total Power Supply (Generation):")
print(f"  Hydro Gen. = {s_hydro_gen:.1f} MVA * {pf_sources} PF = {p_hydro_gen:.2f} MW")
print(f"  PV (delivered) = ({s_pv:.1f} MVA * {pf_pv} PF) * (1 - {pv_transmission_loss_rate}) = {p_pv_delivered:.4f} MW")
print(f"  Mini Hydro Gen. = {s_mini_hydro_gen:.1f} MVA * {pf_sources} PF = {p_mini_hydro_gen:.2f} MW")
print(f"  Total Generation = {p_hydro_gen:.2f} + {p_pv_delivered:.4f} + {p_mini_hydro_gen:.2f} = {total_generation_power:.4f} MW")
print()

print("3. Net Real Power Demand on Bus 11:")
print(f"  Net Demand = Total Load - Total Generation")
print(f"  Net Demand = {total_load_power:.4f} MW - {total_generation_power:.4f} MW")
print(f"  Final Net Demand = {net_real_power_demand:.4f} MW")
print("-" * 60)
print(f"The final equation is: ({p_load1} + {p_load2} * 1.05 + {p_load3} + {p_load4} * 1.05 + {p_load5}) - ({s_hydro_gen} * {pf_sources} + {s_pv} * {pf_pv} * (1 - {pv_transmission_loss_rate}) + {s_mini_hydro_gen} * {pf_sources}) = {net_real_power_demand:.4f} MW")

# Final answer in the required format
# print(f'<<<{net_real_power_demand:.4f}>>>')