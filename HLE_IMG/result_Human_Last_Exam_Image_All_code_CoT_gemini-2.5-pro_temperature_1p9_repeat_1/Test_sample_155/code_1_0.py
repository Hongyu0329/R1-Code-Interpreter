# Constants and given values
# Power factors
pf_sources = 0.9
pf_pv = 0.92

# Apparent Power (MVA)
s_hydro_gen = 2.0
s_mini_hydro_gen = 1.2
s_pv_gen = 3.0

# Real Power Loads (MW)
p_load1 = 1.89
p_load2 = 1.75
p_load3 = 1.7
p_load4 = 1.9
p_load5 = 2.4

# Losses
transmission_loss_pv_pct = 0.04
harmonic_loss_pct = 0.05

print("Step 1: Calculate real power supplied by each generator.")
# Real power (P = S * PF)
p_hydro_gen = s_hydro_gen * pf_sources
print(f"Real power from Hydro Generator = {s_hydro_gen} MVA * {pf_sources} PF = {p_hydro_gen:.2f} MW")

p_mini_hydro_gen = s_mini_hydro_gen * pf_sources
print(f"Real power from Mini Hydro Generator = {s_mini_hydro_gen} MVA * {pf_sources} PF = {p_mini_hydro_gen:.2f} MW")

p_pv_generated = s_pv_gen * pf_pv
p_pv_supplied = p_pv_generated * (1 - transmission_loss_pv_pct)
print(f"Real power generated by PV system = {s_pv_gen} MVA * {pf_pv} PF = {p_pv_generated:.2f} MW")
print(f"Real power from PV after {transmission_loss_pv_pct*100}% loss = {p_pv_generated:.2f} MW * (1 - {transmission_loss_pv_pct}) = {p_pv_supplied:.4f} MW\n")


print("Step 2: Calculate total real power demand from loads, including losses.")
# Real power of loads with harmonic losses
p_load2_total = p_load2 * (1 + harmonic_loss_pct)
print(f"Total power for Load 2 with {harmonic_loss_pct*100}% harmonic loss = {p_load2} MW * (1 + {harmonic_loss_pct}) = {p_load2_total:.4f} MW")

p_load4_total = p_load4 * (1 + harmonic_loss_pct)
print(f"Total power for Load 4 with {harmonic_loss_pct*100}% harmonic loss = {p_load4} MW * (1 + {harmonic_loss_pct}) = {p_load4_total:.3f} MW\n")


print("Step 3: Calculate the net power demand on Bus 11 from each connected branch.")
# Net demand from each branch. Positive means demand, negative means supply.
net_branch_14 = p_load1 - p_hydro_gen
print(f"Net demand from Load 1 / Hydro Gen branch = {p_load1:.2f} MW - {p_hydro_gen:.2f} MW = {net_branch_14:.2f} MW")

net_branch_13 = p_load2_total
print(f"Net demand from Load 2 branch = {net_branch_13:.4f} MW")

net_branch_12 = p_load3
print(f"Net demand from Load 3 branch = {net_branch_12:.1f} MW")

net_branch_9 = p_load4_total - p_pv_supplied
print(f"Net demand from Load 4 / PV branch = {p_load4_total:.3f} MW - {p_pv_supplied:.4f} MW = {net_branch_9:.4f} MW")

net_branch_6 = p_load5 - p_mini_hydro_gen
print(f"Net demand from Load 5 / Mini Hydro branch = {p_load5:.1f} MW - {p_mini_hydro_gen:.2f} MW = {net_branch_6:.2f} MW\n")


print("Step 4: Calculate the total net real power demand on Bus 11.")
total_net_demand = net_branch_14 + net_branch_13 + net_branch_12 + net_branch_9 + net_branch_6
print("Total Net Demand = (Net demand from branch 14) + (Net demand from branch 13) + (Net demand from branch 12) + (Net demand from branch 9) + (Net demand from branch 6)")
print(f"Total Net Demand = {net_branch_14:.2f} + {net_branch_13:.4f} + {net_branch_12:.1f} + ({net_branch_9:.4f}) + {net_branch_6:.2f}")
print(f"Total Net Demand = {total_net_demand:.4f} MW")
print("<<<4.2929>>>")