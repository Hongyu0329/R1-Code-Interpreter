import math

# Step 1 & 2: Define initial values and conditions
# Load values (MW)
p_load1 = 1.89
p_load2_base = 1.75
p_load3 = 1.7
p_load4_base = 1.9
p_load5 = 2.4

# Generation values (MVA)
s_hydro = 2.0
s_mini_hydro = 1.2
s_pv = 3.0

# Power Factors
pf_sources = 0.9
pf_pv = 0.92

# Losses
harmonic_loss_pct = 0.05
pv_transmission_loss_pct = 0.04

# Step 3: Calculate total real power load, considering losses
# Harmonic loss for Load 2 and Load 4 increases their power consumption
p_load2_actual = p_load2_base * (1 + harmonic_loss_pct)
p_load4_actual = p_load4_base * (1 + harmonic_loss_pct)

# Total real power load
total_load_power = p_load1 + p_load2_actual + p_load3 + p_load4_actual + p_load5

# Step 4: Calculate total real power generation delivered to Bus 11
# Real power from Hydro Generator
p_hydro = s_hydro * pf_sources

# Real power from Mini Hydro Generator
p_mini_hydro = s_mini_hydro * pf_sources

# Real power generated by PV system
p_pv_generated = s_pv * pf_pv
# Real power from PV system after transmission losses
p_pv_delivered = p_pv_generated * (1 - pv_transmission_loss_pct)

# Total real power generation
total_generation_power = p_hydro + p_mini_hydro + p_pv_delivered

# Step 5: Calculate the net real power demand on Bus 11
net_demand_power = total_load_power - total_generation_power

# Print the detailed calculation
print("Calculation of Total Real Power Load:")
print(f"P_Load_Total = P_Load1 + P_Load2_actual + P_Load3 + P_Load4_actual + P_Load5")
print(f"P_Load_Total = {p_load1} MW + ({p_load2_base} MW * (1 + {harmonic_loss_pct})) + {p_load3} MW + ({p_load4_base} MW * (1 + {harmonic_loss_pct})) + {p_load5} MW")
print(f"P_Load_Total = {p_load1} MW + {p_load2_actual:.4f} MW + {p_load3} MW + {p_load4_actual:.4f} MW + {p_load5} MW")
print(f"P_Load_Total = {total_load_power:.4f} MW\n")


print("Calculation of Total Real Power Generation:")
print(f"P_Gen_Total = P_Hydro + P_Mini_Hydro + P_PV_delivered")
print(f"P_Gen_Total = ({s_hydro} MVA * {pf_sources}) + ({s_mini_hydro} MVA * {pf_sources}) + (({s_pv} MVA * {pf_pv}) * (1 - {pv_transmission_loss_pct}))")
print(f"P_Gen_Total = {p_hydro:.4f} MW + {p_mini_hydro:.4f} MW + {p_pv_delivered:.4f} MW")
print(f"P_Gen_Total = {total_generation_power:.4f} MW\n")

print("Calculation of Net Real Power Demand on Bus 11:")
print(f"P_Net_Demand = P_Load_Total - P_Gen_Total")
print(f"P_Net_Demand = {total_load_power:.4f} MW - {total_generation_power:.4f} MW")
print(f"P_Net_Demand = {net_demand_power:.4f} MW")
