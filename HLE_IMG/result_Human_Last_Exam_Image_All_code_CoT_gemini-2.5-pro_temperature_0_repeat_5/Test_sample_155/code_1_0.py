import math

# Step 1: Define given values from the problem description and diagram

# Load real power values (MW)
p_load1 = 1.89
p_load2 = 1.75
p_load3 = 1.7
p_load4 = 1.9
p_load5 = 2.4

# Generator apparent power values (MVA)
s_hydro_gen = 2.0
s_mini_hydro_gen = 1.2
s_pv = 3.0

# Power factors
pf_sources = 0.9  # For Hydro and Mini Hydro generators
pf_pv = 0.92      # For Photovoltaic system

# Losses
harmonic_loss_percent = 5.0
pv_transmission_loss_percent = 4.0

# Step 2: Calculate the total real power consumed by loads, including losses

# Harmonic loss increases the power drawn by Load 2 and Load 4
harmonic_loss_factor = 1 + (harmonic_loss_percent / 100)
p_load2_actual = p_load2 * harmonic_loss_factor
p_load4_actual = p_load4 * harmonic_loss_factor

# Sum of all loads
total_load_power = p_load1 + p_load2_actual + p_load3 + p_load4_actual + p_load5

print("--- Load Calculation ---")
print(f"Load 1 Power: {p_load1:.4f} MW")
print(f"Load 2 Power (rated): {p_load2:.2f} MW, with {harmonic_loss_percent}% harmonic loss: {p_load2_actual:.4f} MW")
print(f"Load 3 Power: {p_load3:.4f} MW")
print(f"Load 4 Power (rated): {p_load4:.2f} MW, with {harmonic_loss_percent}% harmonic loss: {p_load4_actual:.4f} MW")
print(f"Load 5 Power: {p_load5:.4f} MW")
print(f"Total Load Power = {p_load1:.2f} + {p_load2_actual:.4f} + {p_load3:.2f} + {p_load4_actual:.4f} + {p_load5:.2f} = {total_load_power:.4f} MW\n")


# Step 3: Calculate the total real power supplied by generators, including losses

# Real power from Hydro Generator
p_hydro_gen = s_hydro_gen * pf_sources

# Real power from Mini Hydro Generator
p_mini_hydro_gen = s_mini_hydro_gen * pf_sources

# Real power generated by PV system
p_pv_generated = s_pv * pf_pv
# Real power delivered by PV system after transmission loss
pv_transmission_loss_factor = 1 - (pv_transmission_loss_percent / 100)
p_pv_delivered = p_pv_generated * pv_transmission_loss_factor

# Sum of all generation
total_generation_power = p_hydro_gen + p_mini_hydro_gen + p_pv_delivered

print("--- Generation Calculation ---")
print(f"Hydro Gen. Power Delivered: {s_hydro_gen:.2f} MVA * {pf_sources:.2f} PF = {p_hydro_gen:.4f} MW")
print(f"Mini Hydro Gen. Power Delivered: {s_mini_hydro_gen:.2f} MVA * {pf_sources:.2f} PF = {p_mini_hydro_gen:.4f} MW")
print(f"PV Power Delivered: ({s_pv:.2f} MVA * {pf_pv:.2f} PF) * (1 - {pv_transmission_loss_percent/100:.2f} loss) = {p_pv_delivered:.4f} MW")
print(f"Total Generation Power = {p_hydro_gen:.4f} + {p_mini_hydro_gen:.4f} + {p_pv_delivered:.4f} = {total_generation_power:.4f} MW\n")


# Step 4: Calculate the net real power demand on Bus 11

net_power_demand = total_load_power - total_generation_power

print("--- Net Power Demand Calculation ---")
print("Net Real Power Demand = Total Load Power - Total Generation Power")
print(f"Net Demand = ({p_load1:.2f} + {p_load2_actual:.4f} + {p_load3:.2f} + {p_load4_actual:.4f} + {p_load5:.2f}) - ({p_hydro_gen:.4f} + {p_mini_hydro_gen:.4f} + {p_pv_delivered:.4f})")
print(f"Net Demand = {total_load_power:.4f} MW - {total_generation_power:.4f} MW")
print(f"Net Demand = {net_power_demand:.4f} MW")

# Final Answer
# The format <<<answer>>> is a special instruction for the system.
# The final result is printed here.
print(f"\nThe final calculated net real power demand on Bus 11 is {net_power_demand:.4f} MW.")
print(f"<<<{net_power_demand:.4f}>>>")