# Step 1: Define the nominal real power for each load from the diagram (in MW)
p_load1 = 1.89  # MW
p_load2 = 1.75  # MW
p_load3 = 1.7   # MW
p_load4 = 1.9   # MW
p_load5 = 2.4   # MW

# Step 2: Define the apparent power for the co-located generator (in MVA)
s_hydro_gen = 2.0  # MVA

# Step 3: Define the given power factors and losses
pf_sources = 0.9  # Power factor for all sources (including Hydro Gen)
harmonic_loss_factor = 1.05  # 5% harmonic loss means multiplying by 1.05

# Step 4: Calculate the adjusted real power demand for loads with harmonic losses
p_load2_adj = p_load2 * harmonic_loss_factor
p_load4_adj = p_load4 * harmonic_loss_factor

# Step 5: Calculate the real power generated by the Hydro Generator
p_hydro_gen = s_hydro_gen * pf_sources

# Step 6: Calculate the net real power demand from the branch serving Load 1 and Hydro Gen
# This branch has a load (1.89 MW) and a generator (Hydro Gen).
# The net demand on Bus 11 from this branch is the load minus the generation.
net_demand_branch_1 = p_load1 - p_hydro_gen

# Step 7: The demands from other branches are the adjusted load values
# Branch for Load 2, 3, 4
demand_branch_234 = p_load2_adj + p_load3 + p_load4_adj
# Branch for Load 5
demand_branch_5 = p_load5

# Step 8: Sum the demands from all branches to get the total net real power demand on Bus 11
total_net_demand = net_demand_branch_1 + demand_branch_234 + demand_branch_5

# Print the detailed calculation and the final result
print("Calculating the total net real power demand on Bus 11:")
print("Net Demand = (Load 1 - Hydro Gen) + (Adjusted Load 2) + (Load 3) + (Adjusted Load 4) + (Load 5)")
print(f"Equation: ({p_load1} MW - {p_hydro_gen:.2f} MW) + ({p_load2} MW * {harmonic_loss_factor}) + {p_load3} MW + ({p_load4} MW * {harmonic_loss_factor}) + {p_load5} MW")
print(f"Calculated values: ({net_demand_branch_1:.2f} MW) + ({p_load2_adj:.4f} MW) + {p_load3} MW + ({p_load4_adj:.4f} MW) + {p_load5} MW = {total_net_demand:.4f} MW")
print(f"\nThe total net real power demand on Bus 11 is {total_net_demand:.4f} MW.")
print("<<<8.0225>>>")