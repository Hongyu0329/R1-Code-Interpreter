import math

# --- Given Data from the Problem ---

# Loads (Real Power in MW)
P_L1 = 1.89
P_L2 = 1.75
P_L3 = 1.7
P_L4 = 1.9
P_L5 = 2.4

# Generators (Apparent Power in MVA)
S_hydro_gen = 2.0
S_mini_hydro_gen = 1.2
S_pv = 3.0

# Power Factors
pf_sources = 0.9  # For Hydro Gen and Mini Hydro Gen
pf_pv = 0.92      # For Photovoltaic system

# Losses percentages
harmonic_loss_percent = 5.0
pv_transmission_loss_percent = 4.0

# --- Step 1: Calculate Total Real Power Load ---

# The 5% harmonic loss increases the power drawn by the loads.
harmonic_loss_multiplier = 1 + (harmonic_loss_percent / 100)
P_L2_effective = P_L2 * harmonic_loss_multiplier
P_L4_effective = P_L4 * harmonic_loss_multiplier

# Sum of all individual loads
P_load_total = P_L1 + P_L2_effective + P_L3 + P_L4_effective + P_L5

# --- Step 2: Calculate Total Real Power Generation ---

# Real power from Hydro Generator
P_hydro_gen = S_hydro_gen * pf_sources

# Real power from Mini Hydro Generator
P_mini_hydro_gen = S_mini_hydro_gen * pf_sources

# Real power generated by the Photovoltaic system before losses
P_pv_generated = S_pv * pf_pv

# Real power from PV delivered to Bus 11 after 4% transmission loss
pv_transmission_loss_multiplier = 1 - (pv_transmission_loss_percent / 100)
P_pv_delivered = P_pv_generated * pv_transmission_loss_multiplier

# Sum of all generation sources (BESS is assumed to be 0 MW as no power value is given)
P_gen_total = P_hydro_gen + P_mini_hydro_gen + P_pv_delivered

# --- Step 3: Calculate Net Real Power Demand on Bus 11 ---
# Net Demand = Total Load - Total Generation
net_demand = P_load_total - P_gen_total

# --- Step 4: Print the detailed calculation and final equation ---
print("This script calculates the total net real power demand on Bus 11.")
print("\n--- Calculation Breakdown ---")

# Load Calculation Details
print("\n1. Total Real Power Load:")
print(f"  - Load 1: {P_L1:.2f} MW")
print(f"  - Load 2 (incl. {harmonic_loss_percent}% harmonic loss): {P_L2:.2f} MW * {harmonic_loss_multiplier:.2f} = {P_L2_effective:.4f} MW")
print(f"  - Load 3: {P_L3:.2f} MW")
print(f"  - Load 4 (incl. {harmonic_loss_percent}% harmonic loss): {P_L4:.2f} MW * {harmonic_loss_multiplier:.2f} = {P_L4_effective:.4f} MW")
print(f"  - Load 5: {P_L5:.2f} MW")
print(f"  Total Load = {P_L1:.2f} + {P_L2_effective:.4f} + {P_L3:.2f} + {P_L4_effective:.4f} + {P_L5:.2f} = {P_load_total:.4f} MW")

# Generation Calculation Details
print("\n2. Total Real Power Generation:")
print(f"  - Hydro Gen: {S_hydro_gen:.1f} MVA * {pf_sources:.1f} PF = {P_hydro_gen:.2f} MW")
print(f"  - Mini Hydro Gen: {S_mini_hydro_gen:.1f} MVA * {pf_sources:.1f} PF = {P_mini_hydro_gen:.2f} MW")
print(f"  - Photovoltaic (incl. {pv_transmission_loss_percent}% transmission loss): ({S_pv:.1f} MVA * {pf_pv:.2f} PF) * {pv_transmission_loss_multiplier:.2f} = {P_pv_delivered:.4f} MW")
print(f"  Total Generation = {P_hydro_gen:.2f} + {P_mini_hydro_gen:.2f} + {P_pv_delivered:.4f} = {P_gen_total:.4f} MW")

# Net Demand Calculation
print("\n3. Net Real Power Demand on Bus 11:")
print(f"  Net Demand = Total Load - Total Generation")
print(f"  Net Demand = {P_load_total:.4f} MW - {P_gen_total:.4f} MW = {net_demand:.4f} MW")

# Final Equation with all numbers as requested
print("\n--- Final Equation ---")
load_eq_str = f"({P_L1} + {P_L2} * {harmonic_loss_multiplier} + {P_L3} + {P_L4} * {harmonic_loss_multiplier} + {P_L5})"
gen_eq_str = f"({S_hydro_gen} * {pf_sources} + {S_mini_hydro_gen} * {pf_sources} + {S_pv} * {pf_pv} * {pv_transmission_loss_multiplier})"
print(f"Net Demand = {load_eq_str} - {gen_eq_str}")
print(f"Net Demand = {P_load_total:.4f} - {P_gen_total:.4f} = {net_demand:.4f} MW")