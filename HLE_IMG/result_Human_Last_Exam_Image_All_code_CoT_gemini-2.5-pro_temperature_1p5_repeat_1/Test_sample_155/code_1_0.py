import math

# --- Problem Data ---

# Load real power values in MW from the diagram
p_load1 = 1.89
p_load2 = 1.75
p_load3 = 1.7
p_load4 = 1.9
p_load5 = 2.4

# Photovoltaic (PV) system data
s_pv = 3.0  # MVA
pf_pv = 0.92

# Loss percentages
harmonic_loss_pct = 5.0
transmission_loss_pct = 4.0

# --- Calculation Steps ---

# Step 1: Calculate the actual power demand for loads considering harmonic losses.
# The harmonic loss increases the power drawn from the system.
harmonic_multiplier = 1 + (harmonic_loss_pct / 100)
p_load2_actual = p_load2 * harmonic_multiplier
p_load4_actual = p_load4 * harmonic_multiplier

# Step 2: Sum all load demands to find the total gross demand on Bus 11.
total_load_demand = p_load1 + p_load2_actual + p_load3 + p_load4_actual + p_load5

# Step 3: Calculate the real power generated by the PV system.
# Real Power (P) = Apparent Power (S) * Power Factor (PF)
p_pv_generated = s_pv * pf_pv

# Step 4: Calculate the net power from the PV system after transmission losses.
# The power reaching Bus 11 is reduced by the loss percentage.
transmission_loss_factor = 1 - (transmission_loss_pct / 100)
p_pv_net_injected = p_pv_generated * transmission_loss_factor

# Step 5: Calculate the final net real power demand on Bus 11.
# Net Demand = Total Load Demand - Net Power Injected
net_demand_on_bus11 = total_load_demand - p_pv_net_injected


# --- Output the results ---

print("This script calculates the total net real power demand on Bus 11.")
print("-----------------------------------------------------------------\n")

print("Step 1: Calculating Total Real Power Load")
print(f"Load 1 Demand: {p_load1:.2f} MW")
print(f"Load 2 Demand (including {harmonic_loss_pct}% harmonic loss): {p_load2:.2f} * {harmonic_multiplier:.2f} = {p_load2_actual:.4f} MW")
print(f"Load 3 Demand: {p_load3:.2f} MW")
print(f"Load 4 Demand (including {harmonic_loss_pct}% harmonic loss): {p_load4:.2f} * {harmonic_multiplier:.2f} = {p_load4_actual:.4f} MW")
print(f"Load 5 Demand: {p_load5:.2f} MW")
print(f"Total Gross Load Demand = {total_load_demand:.4f} MW\n")

print("Step 2: Calculating Net Power Injected by PV System")
print(f"PV Power Generated: {s_pv:.1f} MVA * {pf_pv:.2f} PF = {p_pv_generated:.4f} MW")
print(f"Net PV Power Injected (after {transmission_loss_pct}% transmission loss): {p_pv_generated:.4f} MW * {transmission_loss_factor:.2f} = {p_pv_net_injected:.4f} MW\n")

print("Step 3: Calculating Net Real Power Demand on Bus 11")
print(f"Net Demand = Total Gross Load - Net PV Power Injected")
print(f"Net Demand = {total_load_demand:.4f} MW - {p_pv_net_injected:.4f} MW = {net_demand_on_bus11:.4f} MW\n")

print("Final Equation:")
print(f"({p_load1} + {p_load2}*{harmonic_multiplier} + {p_load3} + {p_load4}*{harmonic_multiplier} + {p_load5}) - ({s_pv} * {pf_pv} * {transmission_loss_factor}) = {net_demand_on_bus11:.4f} MW")

print(f"\n<<<7.1729>>>")